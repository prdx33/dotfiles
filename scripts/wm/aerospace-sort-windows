#!/bin/zsh
# Sort windows into letter-based workspaces (matching Meh app-launch bindings)
# Each letter workspace = the Meh+key binding for that app

typeset -A APP_WORKSPACE
APP_WORKSPACE=(
  # B = Bloom
  "Bloom" "B"
  # C = Claude
  "Claude" "C"
  # D = Obsidian
  "Obsidian" "D"
  # F = Firefox (+ browser aliases)
  "Firefox" "F"
  "Safari" "F"
  "Brave Browser" "F"
  # G = Ghostty (+ terminal aliases)
  "Ghostty" "G"
  "Terminal" "G"
  "Warp" "G"
  # H = HazeOver
  "HazeOver" "H"
  # K = Karabiner
  "Karabiner-EventViewer" "K"
  "Karabiner-Elements" "K"
  # L = Little Snitch
  "Little Snitch" "L"
  # O = Google Chrome
  "Google Chrome" "O"
  # Q = 1Password
  "1Password" "Q"
  # R = Spark
  "Spark" "R"
  # S = Spotify (+ music aliases)
  "Spotify" "S"
  "Music" "S"
  # V = VS Code (+ editor aliases)
  "Visual Studio Code" "V"
  "Code" "V"
  "Cursor" "V"
  # W = WhatsApp
  "WhatsApp" "W"
)

/opt/homebrew/bin/aerospace list-windows --all --format '%{window-id}|%{app-name}' | while IFS='|' read -r WID APP; do
  WS="${APP_WORKSPACE[$APP]}"
  if [[ -n "$WS" ]]; then
    /opt/homebrew/bin/aerospace move-node-to-workspace --window-id "$WID" "$WS" 2>/dev/null
  fi
done
