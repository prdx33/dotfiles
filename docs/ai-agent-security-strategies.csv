Tier,Rank,Strategy,Description,Credit (Reddit u/),Thread Context,Our Architecture Layer,Implementation Priority,Status
Tier 1: Core,1,Secrets Manager (1Password CLI / Vault / Doppler),Secrets injected at runtime via op run. Never stored in files or env vars. Claude can't printenv them because they never existed in its shell.,u/cuba_guy u/rjyo u/AM1010101 u/iblaine_reddit,cuba_guy: "I don't store any secrets in files or in my environment. Claude is wrapped in op (1password) command that injects needed secrets.",Layer 1: Secret Isolation,Immediate,Not started
Tier 1: Core,2,Eliminate .env files entirely,Stop using .env files as a secret storage mechanism. If the file doesn't exist docker compose config and cat and grep and git log all fail.,u/graymalkcat u/nikc9,graymalkcat: "We have to move away from using things like .env. That solution solved an old problem. Now we have a new one.",Layer 1: Secret Isolation,Immediate,Not started
Tier 1: Core,3,Never expose Docker socket to agent,Docker socket access = root access. This is exactly how OP got owned. Claude used docker compose config to extract keys from compose files.,u/rjyo u/quietbat_ u/xVinci,quietbat_: "docker access = root access. that's the lesson.",Layer 2: Containment,Immediate,Not started
Tier 1: Core,4,Container/VM isolation for agent execution,Run the agent in its own sandboxed container or VM. It only sees what you explicitly mount in. Most-repeated advice in the thread.,u/rjyo u/grumbly u/aradil u/xVinci u/thecodeassassin u/Much-Researcher6135 u/raesene2 u/citrusaus0,grumbly: "Running agents in a container is so low bar that I'm amazed people run them on their host machine at all.",Layer 2: Containment,Phase 2 (Mac Mini),Not started
Tier 1: Core,5,PreToolUse hooks blocking secret access patterns,Deterministic algorithmic enforcement before Claude acts. Catches cat .env and grep for secrets and docker compose config and printenv. Claude can't talk its way past exit 2.,u/FootSureDruid u/iblaine_reddit,FootSureDruid: "I use PreToolUse hooks. Deterministic and enforced before Claude tries to run anything.",Layer 2: Self-Defence,Immediate,Not started
Tier 1: Core,6,YubiKey for SSH/AWS/critical operations,Hardware-bound credentials that physically cannot be copied or exfiltrated. Even without touch enabled the key material never leaves the device.,u/ShelZuuz,ShelZuuz: "Use a Yubikey. Even if you don't enable touch — at least nobody can copy a key off it and the keys are only meaningful on your own machine.",Layer 3: Hardware Gates,Phase 2,Not started
Tier 1: Core,7,Secrets proxy — swap placeholders for real values at runtime,Claude only sees ${DB_URL} placeholder. Your infrastructure resolves it to the real value. Claude writes code with placeholders and never sees actual secrets.,u/PreviousLadder7795,PreviousLadder7795: "The only solution is to move secrets outside of your code via proxies. You say when I see this thing proxied through me I will swap it out with the real thing.",Layer 1: Secret Isolation,Phase 1,Not started
Tier 2: Defence in Depth,8,Run agent as separate low-privilege user,OS-level permission isolation. Claude-user can't read files owned by your primary user account. Simple and effective.,u/256BitChris u/HelpfulBuilder u/_tresmil_,256BitChris: "You can run it as a different user so you can get all the OS level permission protections.",Layer 2: Containment,Phase 1,Not started
Tier 2: Defence in Depth,9,Scope file permissions to working directory only,Claude's default is read access to entire machine. Native sandbox restricts filesystem access to project directory only.,u/rjyo u/256BitChris u/kwar,kwar: "By default Claude can read your ENTIRE machine barring a few directories.",Layer 2: Containment,Immediate,Not started
Tier 2: Defence in Depth,10,Separate dev and production environments,Production keys live in CI/CD only. Claude works in dev which has no access to prod secrets or infrastructure.,u/Cute_Witness3405 u/nikc9,nikc9: "prod keys should be in ci/cd and isolated from your agent completely.",Layer 1: Secret Isolation,Phase 1,Not started
Tier 2: Defence in Depth,11,Credential scanning before launching agent,Pre-flight check: scan workspace for leaked secrets before Claude starts. If secrets found abort the session.,u/xVinci,xVinci: "Credential scanning before launching" (from 500+ dev company security practices),Layer 2: Self-Defence,Phase 1,Not started
Tier 2: Defence in Depth,12,Block cat/grep/docker on secret paths not just Read tool,Critical insight: Bash(cat *) is explicitly allowed in most configs. Claude bypasses Read deny rules by shelling out. Hooks must catch bash-level access too.,u/mxlsr u/rafter-security u/sinthorius,rafter-security: "Bash(cat *) is explicitly allowed. I dispatched it to circumvent the settings and it found real env files I didn't even know about.",Layer 2: Self-Defence,Immediate,Not started
Tier 2: Defence in Depth,13,Red-team your own setup iteratively,Let Claude try to find all your secrets. Fix the holes. Rotate the found secrets. Repeat until it can't find anything.,u/aabajian,aabajian: "Let the agent go on a quest to find all your secrets. Then have it lock them down. Then you change them. Rinse and repeat until it can't find them.",Layer 2: Self-Defence,After initial setup,Not started
Tier 2: Defence in Depth,14,Tell Claude to STOP and REPORT rather than must not,Reframe incentives. Instead of forbidding actions (which triggers workarounds) make Claude positively motivated to stop and report obstacles.,u/lucianw,lucianw: "I stopped using IMPORTANT: you must not because the agent thinks it helps me by finding a workaround. I tell it that I am positively happy to learn it stopped at one of these obstacles.",Layer 2: Self-Defence,Immediate,Not started
Tier 2: Defence in Depth,15,DB credentials scoped to read/write never admin,Least privilege on the credentials themselves. Even if Claude gets DB access it can't DROP or DELETE.,u/60secs,60secs: "Claude dropped and recreated one of my RDS databases. Lessons: make sure your db creds are read/write not admin.",Layer 1: Secret Isolation,Phase 1,Not started
Tier 2: Defence in Depth,16,Non-root container user + restrict skip-permissions in container,Belt and suspenders inside the sandbox. Even inside a container run as non-root and don't allow --dangerously-skip-permissions.,u/xVinci,xVinci: "Non-root user; NOT exposing the docker socket to the container; Restricting skip permissions mode even though you are in a container" (500+ dev company),Layer 2: Containment,Phase 2,Not started
Tier 2: Defence in Depth,17,Isolated VM on separate network for agent execution,Dedicated VM on isolated network segment. Everything managed by git. Physical and network air gap.,u/Much-Researcher6135 u/raesene2 u/citrusaus0,citrusaus0: "Dedicated vm on an isolated network. Everything managed by git. Backups of the git env taken away from Claude's view.",Layer 3: Hardware Gates,Phase 2 (Mac Mini),Not started
Tier 3: Good Hygiene,18,Git-based workflow separation (dev repo vs prod),Claude manages configs in dev repo. You pull to prod separately. Claude never touches production environment directly.,u/Cute_Witness3405,Cute_Witness3405: "Push that repo to GitHub. Clone into a separate dev directory. This is where you let Claude Code manage your configurations.",N/A,When convenient,Not started
Tier 3: Good Hygiene,19,macOS Keychain with Touch ID for env var injection,Biometric gate on secret access. Store env var sets in Keychain and require Touch ID to release them.,u/thatfool,thatfool: "I use a tool that lets you put sets of environment variables in the macOS keychain and then run programs with those stored environments requiring touch ID to access them.",Layer 1: Secret Isolation,When convenient,Not started
Tier 3: Good Hygiene,20,Rotate keys after every production push,Safety net rotation schedule. Less critical when secrets are invisible but good practice regardless.,u/Various_Procedure672 u/throwaway-011110,Various_Procedure672: "My solution was to rotate keys once I push it to a production system.",N/A,When convenient,Not started
Tier 3: Good Hygiene,21,Remove DROP/destructive statements from DDL files,Reduce accidental database destruction. DDL files shouldn't have DROP TABLE at the top.,u/60secs,60secs: "DDL sql files probably don't need those DROP statements at the top.",N/A,When convenient,Not started
Tier 3: Good Hygiene,22,Encrypt secrets at rest + sandbox,If secrets must exist on disk encrypt them. Less needed with proper secrets manager.,u/mxlsr,mxlsr: "Encrypting the keys + sandboxing is the way to go.",Layer 1: Secret Isolation,When convenient,Not started
Tier 3: Good Hygiene,23,Deterministic verification layers (types/lint/hooks),Build constraint systems where AI is untrusted producer and you are the verification layer. 90% deterministic 10% agentic.,u/JWPapi,JWPapi: "The mindset shift: you are now the verification layer. The AI is an untrusted producer. Every output is suspect until proven otherwise through your deterministic checks.",Layer 2: Self-Defence,When convenient,Not started
Tier 3: Good Hygiene,24,Push to private git server not GitHub,Reduces exposure if agent pushes code. Self-hosted Gitea or similar.,u/3spky5u-oss,3spky5u-oss: "I push to my private gitea on my home server often.",N/A,When convenient,Not started
Tier 3: Good Hygiene,25,allowUnsandboxedCommands: false,One setting in Claude Code config. Blocks the dangerouslyDisableSandbox escape hatch permanently.,Claude Code docs,Documented escape hatch that can be welded shut with one config change.,Layer 2: Containment,Immediate,Not started
Tier 4: Redundant,26,Use browser-only Claude with copy-paste workflow,Kills agent value proposition entirely. We're building guardrails so you don't have to do this.,u/trisanachandler u/Kakabef u/kevkaneki,kevkaneki: "I refuse to use Claude code. I use the UI version with the projects feature.",N/A,Skip,N/A
Tier 4: Redundant,27,Run in bypass mode on disposable nuke-friendly environment,Security-by-not-caring. Only works if nothing on the machine matters.,u/haywire u/3spky5u-oss,haywire: "Just run in bypass mode and go to the pub.",N/A,Skip,N/A
Tier 4: Redundant,28,Manual approval of every single command,Causes approval fatigue which is worse for security. You stop reading what you're approving. Sandbox is stronger.,Thread consensus,Multiple users noted that constant approval prompts lead to rubber-stamping.,N/A,Skip,N/A
Tier 4: Redundant,29,Stop using agents entirely,Not a strategy. It's surrender.,Thread lurkers,N/A,N/A,Skip,N/A
Tier 4: Redundant,30,Vultrino proxy tool,Adds a dependency for something 1Password CLI does natively with better support and maintenance.,u/ZachyKing,ZachyKing: "I built Vultrino for this exact reason.",N/A,Skip,N/A
